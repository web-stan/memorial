(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-301fe5e6"],{"05a2":function(t,e,s){"use strict";s("2a7e")},"0df0":function(t,e,s){t.exports=s.p+"img/dashboard-placeholder.a928299c.svg"},1251:function(t,e,s){},"12a3":function(t,e,s){"use strict";s("cb17")},"1b72":function(t,e,s){},"2a7e":function(t,e,s){},"5a57":function(t,e,s){t.exports=s.p+"img/desktop-blue.5f3062c6.svg"},7306:function(t,e,s){},"997e":function(t,e,s){t.exports=s.p+"img/relative-placeholder.911d5812.svg"},"9b25":function(t,e,s){t.exports=s.p+"img/facebook-messenger-1.0f6f9acb.svg"},a79b:function(t,e,s){"use strict";s("f95a")},ab7f:function(t,e,s){t.exports=s.p+"img/envelope-blue.d76ae40e.svg"},bbe3:function(t,e,s){},bf93:function(t,e,s){"use strict";s("7306")},c661:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{directives:[{name:"scroll-lock",rawName:"v-scroll-lock",value:t.isMobile&&t.isMenuShow,expression:"isMobile && isMenuShow"}],class:["edit-memorial__header"].concat(t.classList,[{open:t.isMenuShow}])},[a("div",{staticClass:"memorial-header__main main-block"},[a("div",{staticClass:"main-block__controls"},[a("div",{staticClass:"management",on:{click:function(e){e.preventDefault(),t.isShowMemorialMenu=!t.isShowMemorialMenu}}},[t.memorial&&null!==t.memorial.profilePhoto&&"undefined"!==typeof t.memorial.profilePhoto&&"undefined"!==typeof t.memorial.profilePhoto.url?a("img",{attrs:{src:t.memorial.profilePhoto.url,alt:"avatar"}}):a("img",{attrs:{src:s("0df0"),alt:"avatar"}}),a("div",{staticClass:"management__user"},[a("div",{staticClass:"name"},[a("span",[t._v(t._s(t.memorial.name))]),a("span",{staticClass:"icon caret"})]),a("div",{staticClass:"years"},[a("span",{staticClass:"birth"},[t._v(t._s(t._f("getYear")(t.memorial.birthDate)))]),t._v(" "),a("span",{staticClass:"separator"},[t._v("-")]),t._v(" "),a("span",[t._v(t._s(t._f("getYear")(t.memorial.deathDate)))])])]),t.isShowMemorialMenu?a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideMemorialMenu,expression:"hideMemorialMenu"},{name:"scroll-lock",rawName:"v-scroll-lock",value:t.isShowMemorialMenu,expression:"isShowMemorialMenu"}],class:["memorial-header__memorial-menu",{empty:"undefined"===typeof t.memorials[0]}]},["undefined"!==typeof t.memorials[0]?a("div",{class:["memorial-menu__items"]},t._l(t.memorials,(function(e){return a("div",{key:e.id,class:["memorial-menu__item",{selected:e.id===t.memorial.id}],on:{click:function(s){return t.selectMemorial(e)}}},[null!==e.profilePhoto&&"undefined"!==typeof e.profilePhoto.url?a("img",{attrs:{src:e.profilePhoto.url,alt:"avatar"}}):a("img",{attrs:{src:s("0df0"),alt:""}}),a("span",[t._v(t._s(e.name))])])})),0):t._e(),"undefined"!==typeof t.memorials[0]?a("span",{staticClass:"separator"}):t._e(),a("div",{staticClass:"mobile-menu__item memorial-menu__item add",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.createMemorial(e)}}},[a("span",{staticClass:"plus-icon"}),a("span",{staticClass:"memorial-add-btn"},[t._v(t._s(t.$ml.get("editMemorial.menu.memorials.button")))])])]):t._e()]),a("div",{staticClass:"memorial",on:{click:function(e){e.preventDefault(),t.isShowLinkMenu=!t.isShowLinkMenu}}},["memorial"===this.$route.meta.type?a("span",[t._v(t._s(t.$ml.get("editMemorial.header.memorial")))]):a("span",[t._v(t._s(t.$ml.get("editMemorial.header.dashboard")))]),a("span",{staticClass:"icon caret"}),t.isShowLinkMenu?a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideLinkMenu,expression:"hideLinkMenu"}],staticClass:"context-menu memorial-header__menu-context"},[a("div",{staticClass:"context-menu__items"},[a("div",{staticClass:"context-menu__item",on:{click:t.openMemorial}},[t._v(t._s(t.$ml.get("dashboard.header.menu.memorial")))]),a("router-link",{staticClass:"context-menu__item",attrs:{tag:"div",to:{name:"dashboard.show"}}},[t._v(t._s(t.$ml.get("dashboard.header.menu.dashboard")))])],1)]):t._e()])]),a("div",{class:["mobile-menu__hamburger",{"menu-active":t.isMenuShow}],on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleMenu(e)}}},[a("div",{class:["hamburger",{"menu-active":t.isMenuShow}]},[a("span"),a("span")])]),a("router-link",{staticClass:"main-block__logo",attrs:{tag:"div",to:{name:"home"}}},[a("img",{attrs:{src:s("1ae4"),alt:"Eternity"}})]),a("div",{staticClass:"main-block__profile"},[a("router-link",{class:["main-block__notification"],attrs:{tag:"div",to:{name:"dashboard.show"}}},[a("span",{staticClass:"icon bell-icon"}),t.countStories>0?a("div",{staticClass:"count count__bg"},[a("span",{staticClass:"count__value"},[t._v(t._s(t.countStories))])]):t._e()]),null!==t.user&&null!==t.user.profilePhoto&&"undefined"!==typeof t.user.profilePhoto.url?a("img",{attrs:{src:t.user.profilePhoto.url,alt:"avatar"},on:{click:function(e){t.isShowAvatarMenu=!t.isShowAvatarMenu}}}):a("img",{attrs:{src:s("47ed"),alt:"avatar"},on:{click:function(e){t.isShowAvatarMenu=!t.isShowAvatarMenu}}}),t.isShowAvatarMenu?a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.hideAvatarMenu,expression:"hideAvatarMenu"}],staticClass:"context-menu memorial-header__avatar-menu"},[a("div",{staticClass:"context-menu__items"},[a("router-link",{staticClass:"context-menu__item",attrs:{tag:"div",to:{name:"dashboard.show"}}},[t._v(t._s(t.$ml.get("dashboard.header.menu.dashboard"))+" ")]),a("div",{staticClass:"context-menu__item logout__label",on:{click:t.logout}},[a("span",{staticClass:"icon icon__logout logout__icon"}),t._v(" "+t._s(t.$ml.get("dashboard.header.menu.exit"))+" ")])],1)]):t._e()],1)],1),t.isMenuShow?t._e():a("div",{staticClass:"memorial-header__controls controls-block"},[a("div",{staticClass:"controls-block__second"},[a("Button",{attrs:{classList:["btn","btn-edit",{btn__third:!t.isEditing},{"btn__primary-2":t.isEditing}],label:t.$ml.get("editMemorial.header.edit")},on:{clicked:t.setEditingBlock}},[a("span",{class:["icon","edit-icon",{"icon__edit-blue":!t.isEditing},{icon__edit:t.isEditing}],attrs:{slot:"icon-left"},slot:"icon-left"})]),a("div",{staticClass:"memorial-header__platforms"},[a("Dropdown",{attrs:{defaultText:t.platform,items:t.platforms},on:{selected:t.selectPlatform}})],1),a("div",{staticClass:"memorial-header__languages"},[a("Dropdown",{key:t.langChanged,attrs:{defaultText:t.selectedLanguage.label,items:t.languages},on:{selected:t.selectLanguage}},[a("span",{staticClass:"icon icon__globe-blue",attrs:{slot:"dropdown__icon"},slot:"dropdown__icon"})])],1),a("div",{class:["memorial-header__stories",{after:!t.memorial.paid}]},[a("span",{staticClass:"stories__label"},[t._v(t._s(t.$ml.get("editMemorial.header.stories.label")))]),a("RelativeList",{key:t.memorial.slug,attrs:{classList:["stories__relatives"]}}),a("Button",{attrs:{classList:["btn","btn__third","btn-story"],label:t.$ml.get("editMemorial.header.stories.btn")},on:{clicked:function(e){return t.goTo("memorials.story.share",{slug:t.memorial.id})}}},[a("span",{staticClass:"icon icon__add-blue story-icon",attrs:{slot:"icon-left"},slot:"icon-left"})])],1),t.memorial.paid?t._e():a("Button",{attrs:{classList:["btn","btn__third","btn-payment"],label:t.$ml.get("editMemorial.header.payment")},on:{clicked:function(e){return t.goTo("memorials.payment",{slug:t.memorial.id})}}})],1),a("div",{staticClass:"controls-block__main"},[a("Button",{attrs:{classList:["btn","btn__second","btn-preview"],label:t.$ml.get("editMemorial.header.preview")},on:{clicked:function(e){return t.openPreview()}}}),this.memorial.public?t._e():a("Button",{attrs:{classList:["btn","btn__primary","btn-publish",{disabled:!this.memorial||!this.memorial.paid}],label:t.$ml.get("editMemorial.header.publish")},on:{clicked:t.publishMemorial}})],1)]),t.isMenuShow?a("div",{staticClass:"memorial-header__mobile-menu"},[a("div",{staticClass:"mobile-menu__block memorials"},[a("span",{staticClass:"label"},[t._v(t._s(t.$ml.get("editMemorial.menu.memorials.label")))]),a("div",{staticClass:"mobile-menu__items"},[t._l(t.memorials,(function(e){return a("div",{key:e.id,class:["mobile-menu__item",{selected:e.id===t.memorial.id}],on:{click:function(s){return t.selectMemorial(e)}}},[e.id===t.memorial.id?a("span",{staticClass:"icon icon__selected selected-icon"}):t._e(),null!==e.profilePhoto&&"undefined"!==typeof e.profilePhoto.url?a("img",{attrs:{src:e.profilePhoto.url,alt:"avatar"}}):a("img",{attrs:{src:s("0df0"),alt:""}}),a("span",{staticClass:"name"},[t._v(t._s(e.name))])])})),a("div",{staticClass:"mobile-menu__item",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.createMemorial(e)}}},[a("span",{staticClass:"plus-icon"}),a("span",[t._v(t._s(t.$ml.get("editMemorial.menu.memorials.button")))])])],2)]),a("div",{staticClass:"mobile-menu__block navigation"},[a("span",{staticClass:"label"},[t._v(t._s(t.$ml.get("editMemorial.menu.navigation.label")))]),a("div",{staticClass:"mobile-menu__items"},[a("div",{class:["mobile-menu__item",{selected:"dashboard"===t.$route.meta.type}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openPage("dashboard")}}},["dashboard"===t.$route.meta.type?a("span",{staticClass:"icon icon__selected selected-icon"}):t._e(),a("span",[t._v(t._s(t.$ml.get("editMemorial.menu.navigation.dashboard")))])]),a("div",{class:["mobile-menu__item",{selected:"memorial"===t.$route.meta.type}],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openPage("memorial")}}},["memorial"===t.$route.meta.type?a("span",{staticClass:"icon icon__selected selected-icon"}):t._e(),a("span",[t._v(t._s(t.$ml.get("editMemorial.menu.navigation.memorial")))])])])]),a("div",{staticClass:"mobile-menu__block relatives"},[a("span",{staticClass:"label"},[t._v(t._s(t.$ml.get("editMemorial.menu.relatives.label")))]),a("div",{staticClass:"relatives__content"},[a("RelativeList"),a("div",{staticClass:"relatives__share"},[a("span",{staticClass:"label"},[t._v(t._s(t.$ml.get("create.memorial.step2.form.title")))]),a("div",{staticClass:"relatives-share__content"},[a("span",{staticClass:"relatives-share__label"},[t._v(t._s(t.$ml.get("create.memorial.step2.form.input.description")))]),a("div",{staticClass:"relatives-share__text",attrs:{contenteditable:"true"},on:{input:t.saveText}},[t._v(" "+t._s(t.form.text)+" ")]),a("a",{ref:"link",staticClass:"relatives-share__memorial-link"},[t._v(t._s(t.form.link))]),a("Button",{attrs:{classList:["btn","btn__primary-2","relatives-share__copy-btn"],label:t.$ml.get("create.memorial.step2.form.buttons.copy")},on:{clicked:t.copyLink}},[a("img",{attrs:{slot:"icon-left",src:s("d0b5"),alt:""},slot:"icon-left"})])],1),a("div",{staticClass:"relatives-share__links"},[a("span",[t._v(t._s(t.$ml.get("create.memorial.step2.form.contacts.label")))]),a("a",{staticClass:"relatives-share__link",attrs:{target:"_blank",href:t.fbShareUrl}},[a("img",{attrs:{src:s("e0f6"),alt:""}})]),a("a",{staticClass:"relatives-share__link",attrs:{target:"_blank",href:"#"},on:{click:function(e){return e.preventDefault(),t.shareToMessenger()}}},[a("img",{attrs:{src:s("9b25"),alt:""}})]),a("a",{staticClass:"relatives-share__link",attrs:{target:"_blank",href:"whatsapp://send?text="+encodeURIComponent(t.shareText+"\n"+t.form.link),"data-action":"share/whatsapp/share"}},[a("img",{attrs:{src:s("e4f4"),alt:""}})]),a("a",{staticClass:"relatives-share__link",attrs:{target:"_blank",href:"mailto:?body="+encodeURIComponent(t.shareText+"\n"+t.form.link)}},[a("img",{attrs:{src:s("ab7f"),alt:""}})])])])],1)]),a("div",{staticClass:"mobile-menu__block language"},[a("span",{staticClass:"label"},[t._v(t._s(t.$ml.get("editMemorial.menu.language.label")))]),a("div",{staticClass:"mobile-menu__items"},t._l(t.$ml.list,(function(e){return a("div",{key:e,class:["mobile-menu__item",{selected:e===t.$ml.current}],on:{click:function(s){return s.preventDefault(),s.stopPropagation(),t.changeLang(e)}}},[e===t.$ml.current?a("span",{staticClass:"icon icon__selected selected-icon"}):t._e(),a("span","he"===e?[t._v("עברית")]:[t._v("English")])])})),0)]),a("div",{staticClass:"mobile-menu__block logout"},[a("div",{staticClass:"mobile-menu__items"},[a("div",{class:["mobile-menu__item"],on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.logout(e)}}},[a("span",{staticClass:"icon icon__logout logout__icon"}),a("span",{staticClass:"logout-label"},[t._v(t._s(t.$ml.get("dashboard.header.menu.exit")))])])])]),a("div",{staticClass:"memorial-header__bottom-nav"},[a("div",{staticClass:"menu__title"},[t._v(t._s(t.$ml.get("menu.contacts")))]),a("div",{staticClass:"menu__conection"},[a("div",{staticClass:"menu__conection-item"},[a("a",{staticClass:"menu__relink",attrs:{href:t.$ml.get("contacts.email.url")}},[a("img",{attrs:{src:s("6c07"),alt:""}})]),a("span",[t._v(t._s(t.$ml.get("contacts.email.text")))])]),a("div",{staticClass:"menu__conection-item"},[a("a",{staticClass:"menu__relink",attrs:{href:t.$ml.get("contacts.phone.url")}},[a("img",{attrs:{src:s("e8b5c"),alt:""}})]),a("span",[t._v(t._s(t.$ml.get("contacts.phone.text")))])]),a("div",{staticClass:"menu__conection-item"},[a("a",{staticClass:"menu__relink",attrs:{href:t.$ml.get("contacts.whatsapp.url")}},[a("img",{attrs:{src:s("a2cf"),alt:""}})]),a("span",[t._v(t._s(t.$ml.get("contacts.whatsapp.text")))])])])])]):t._e()])},i=[],o=(s("99af"),s("7db0"),s("b0c0"),s("b64b"),s("9911"),s("5530")),r=(s("96cf"),s("1da1")),n=s("4a9d"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:["relative-list"].concat(t.classList)},[t._l(t.relativeUsers.data,(function(t){return a("div",{staticClass:"relative-list__item"},["undefined"!==typeof t.profilePhoto&&null!==t.profilePhoto&&"ready"===t.profilePhoto.status&&t.profilePhoto.url.length>0?a("img",{attrs:{src:t.profilePhoto.url,alt:"relative"}}):a("img",{attrs:{src:s("997e"),alt:""}})])})),t.relativeUsers.count-6>1?a("div",{staticClass:"relative-list__item count"},[a("span",[t._v(t._s(t.relativeUsers.count-6))]),a("span",{staticClass:"count-plus"},[t._v("+")])]):t._e()],2)},c=[],d=(s("d81d"),s("a434"),s("2f62")),m={name:"RelativeList",props:{relatives:{type:[Array,Object],default:function(){return[]}},classList:{type:[Array,String],default:function(){return[]}}},computed:Object(o["a"])({},Object(d["b"])({memorial:"dashboard/currentMemorial"})),data:function(){return{relativeUsers:{}}},mounted:function(){var t=[];"undefined"!==typeof this.memorial.relations&&(t=this.memorial.relations.map((function(t){return t.user["relationToMemorialPerson"]=t.relationToMemorialPerson,t.user}))),this.relativeUsers={count:t.length,data:t.splice(0,6)}}},u=m,p=(s("cd70"),s("2877")),h=Object(p["a"])(u,l,c,!1,null,"1b9bc744",null),_=h.exports,f=s("2a7d"),b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],staticClass:"dropdown"},[s("div",{staticClass:"dropdown__btn",on:{click:function(e){t.isOpen=!t.isOpen}}},[t._t("dropdown__icon"),s("div",{staticClass:"dropdown__text"},[t._t("dropdown__text",[s("div",{domProps:{innerHTML:t._s(t.text)}})])],2),s("span",{class:["icon","caret","dropdown__caret",{open:t.isOpen}]})],2),t.isOpen?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],staticClass:"dropdown__items"},t._l(t.items,(function(e){return s("div",{key:e.value,staticClass:"dropdown__item",on:{click:function(s){return s.preventDefault(),t.selectItem(e)}}},[s("div",{staticClass:"dropdown__text",on:{click:function(s){return s.preventDefault(),t.selectItem(e)}}},["undefined"!==typeof e.options&&"undefined"!==typeof e.options.tag&&"img"===e.options.tag?s("img",{attrs:{src:e.options.src}}):s("span",{domProps:{innerHTML:t._s(e.label)}})])])})),0):t._e()])},v=[],g=s("53ca"),y={name:"Dropdown",props:{items:{type:Array,default:function(){return[]}},defaultText:{type:[String,Object],default:""}},data:function(){return{isOpen:!1,text:""}},methods:{renderTextFromOptions:function(t){if("undefined"!==typeof t.tag)switch(t.tag){case"img":return'<img src="'.concat(t.src,'" />')}return""},selectItem:function(t){"undefined"!==typeof t.options?this.text=this.renderTextFromOptions(t.options):this.text=t.label,this.$emit("selected",t),this.isOpen=!1},onClickOutside:function(){this.isOpen=!1}},mounted:function(){"object"===Object(g["a"])(this.defaultText)&&"undefined"!==typeof this.defaultText.options?this.text=this.renderTextFromOptions(this.defaultText.options):this.defaultText.length>0&&(this.text=this.defaultText)}},w=y,C=(s("12a3"),Object(p["a"])(w,b,v,!1,null,"42291e0a",null)),k=C.exports,x={name:"Header",components:{Button:f["a"],Dropdown:k,RelativeList:_},props:{classList:{type:[Array,String],default:""},user:{type:Object,default:function(){return{}}},previewRoute:{type:String,default:function(){return null}}},data:function(){return{isEditing:!1,isMenuShow:!1,langChanged:!1,isShowAvatarMenu:!1,isShowLinkMenu:!1,isShowMemorialMenu:!1,platform:{value:"desktop",label:"",options:{tag:"img",src:s("5a57")}},selectedLanguage:{value:"en",label:"English"},languages:[{value:"he",label:"עברית"},{value:"en",label:"English"}],platforms:[{value:"desktop",label:"",options:{tag:"img",src:s("5a57")}},{value:"mobile",label:"",options:{tag:"img",src:s("c881")}}],form:{text:"",link:""}}},methods:{openMemorial:function(){var t=this.$router.resolve({name:"memorials.edit",params:{id:this.memorial.id}});window.open(t.href,"_self")},openPreview:function(){if(this.previewRoute)this.goTo(this.previewRoute,{slug:this.memorial.slug});else{var t=this.$router.resolve({name:"memorials.show",params:{slug:this.memorial.id}});window.open(t.href,"_self")}},hideAvatarMenu:function(){this.isShowAvatarMenu=!1},hideLinkMenu:function(){this.isShowLinkMenu=!1},hideMemorialMenu:function(){this.isShowMemorialMenu=!1},selectPlatform:function(t){this.selectedPlatform=t,this.$emit("changePlatform",this.selectedPlatform.value)},selectLanguage:function(t){this.selectedLanguage=t,this.langChanged=!this.langChanged;var e=document.getElementById("edit-memorial");null!==e&&e.setAttribute("dir","he"===this.selectedLanguage.value?"rtl":"ltr"),this.$emit("changeLanguage",this.selectedLanguage.value)},findLanguage:function(){var t=this;this.selectedLanguage=this.languages.find((function(e){return e.value===t.$ml.current})),this.langChanged=!0},toggleMenu:function(t){t.stopPropagation(),this.isMenuShow=!this.isMenuShow},setEditingBlock:function(){this.$emit("setEditingBlock",{block:"default",isEdit:!this.isEditing})},publishMemorial:function(){if(this.memorial&&this.memorial.paid){var t={memorialId:this.memorial.id,editVersion:this.memorial.editVersion};this.$store.dispatch("dashboard/publishMemorial",t)}},goTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.$router.push({name:t,params:e})},logout:function(){this.$store.dispatch("auth/logout"),this.$router.push({name:"home"})},changeLang:function(t){this.$ml.change(t),document.documentElement.setAttribute("lang",t),document.documentElement.setAttribute("dir","he"===t?"rtl":"ltr")},createMemorial:function(){this.$router.push({name:"memorials.create.welcome"})},selectMemorial:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.$store.dispatch("dashboard/setCurrentMemorial",t.id);case 2:if("memorial"!==e.$route.meta.type){s.next=5;break}return s.next=5,e.$router.push({name:"memorials.edit",params:{id:t.id}});case 5:e.sortMemorials();case 6:case"end":return s.stop()}}),s)})))()},openPage:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!("memorial"===e.$route.meta.type&&"memorial"===t||"dashboard"===e.$route.meta.type&&"dashboard"===t)){s.next=2;break}return s.abrupt("return");case 2:if("memorial"!==t){s.next=5;break}return s.next=5,e.openMemorial();case 5:if("dashboard"!==t){s.next=8;break}return s.next=8,e.$router.push({name:"dashboard.show"});case 8:case"end":return s.stop()}}),s)})))()},shareToMessenger:function(){var t=this.$router.resolve({name:"memorials.story.share",params:{slug:this.memorial.slug}}),e=window.mobileCheck()?"fb-messenger://share?link=".concat(encodeURIComponent(this.form.link)):"https://www.facebook.com/dialog/send?app_id=".concat(Object({NODE_ENV:"production",BASE_URL:"/memorial/"}).VUE_APP_FB_APP_ID,"&display=popup&link=").concat(encodeURIComponent(this.form.link),"&msg=").concat(encodeURIComponent(this.shareText),"&redirect_uri=").concat(encodeURIComponent(window.location.origin+t.href));window.open(e,"_blank")},saveText:function(t){this.$store.dispatch("memorial/saveShareText",t.target.innerText)},copyLink:function(){navigator.clipboard.writeText(this.form.link)},sortMemorials:function(){this.$store.dispatch("dashboard/sortMemorialsByCurrent",this.memorial.id)}},computed:Object(o["a"])(Object(o["a"])({isMobile:function(){return window.innerWidth<768},fbShareUrl:function(){var t=this.$router.resolve({name:"memorials.story.share",params:{slug:this.memorial.slug}});return"https://www.facebook.com/dialog/share?app_id=".concat(Object({NODE_ENV:"production",BASE_URL:"/memorial/"}).VUE_APP_FB_APP_ID,"&display=popup&href=").concat(encodeURIComponent(this.form.link),"&quote=").concat(encodeURIComponent(this.shareText),"&redirect_uri=").concat(encodeURIComponent(window.location.origin+t.href))}},Object(d["b"])({memorials:"dashboard/memorials",memorial:"dashboard/currentMemorial",shareText:"memorial/getShareText"})),{},{countStories:function(){return this.$store.getters["dashboard/countStories"](this.memorial.id)}}),watch:{"memorial.slug":function(t){this.form.text=this.$ml.with("name",this.memorial.name).get("create.memorial.step2.form.input.text"),this.$store.dispatch("story/saveShareText",this.form.text),this.form.link="".concat(window.location.origin,"/memorials/").concat(t,"/share")}},mounted:function(){this.findLanguage();var t=this;n["a"].$on("memorial-edit",(function(e){t.isEditing=e})),this.form.link="".concat(window.location.origin,"/memorials/").concat(this.memorial.slug,"/share"),this.shareText?this.form.text=this.shareText:(this.form.text=this.$ml.with("name",this.memorial.name).get("create.memorial.step2.form.input.text"),this.$store.dispatch("story/saveShareText",this.form.text))},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("dashboard/resetMemorials");case 2:return e.next=4,t.$store.dispatch("dashboard/memorials");case 4:if(0!==t.memorials.length){e.next=7;break}return e.next=7,t.$router.push({name:"memorials.create.welcome"});case 7:if(0!==Object.keys(t.memorial).length){e.next=13;break}if("undefined"===typeof t.memorials[0]||"undefined"===typeof t.memorials[0].id){e.next=11;break}return e.next=11,t.$store.dispatch("dashboard/setCurrentMemorial",t.memorials[0].id);case 11:e.next=15;break;case 13:return e.next=15,t.$store.dispatch("dashboard/setCurrentMemorial",t.memorial.id);case 15:if("memorial"!==t.$route.meta.type||t.$route.params.id===t.memorial.id){e.next=22;break}if(s=t.memorials.find((function(e){return e.id===t.$route.params.id})),a=s.id,null!==a&&"undefined"!==typeof a||(a=t.$route.params.id),null===a||"undefined"===typeof a){e.next=22;break}return e.next=22,t.$store.dispatch("dashboard/setCurrentMemorial",a);case 22:if(t.memorial){e.next=25;break}return e.next=25,t.$router.push({name:"home"});case 25:t.sortMemorials();case 26:case"end":return e.stop()}}),e)})))()}},$=x,M=(s("bf93"),Object(p["a"])($,a,i,!1,null,"4f2f26aa",null));e["a"]=M.exports},c721:function(t,e,s){t.exports=s.p+"img/footer-flag.5e1c9d59.svg"},c881:function(t,e,s){t.exports=s.p+"img/mobile-blue.6f57cba0.svg"},cb17:function(t,e,s){},cd59:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard"},[a("Header",{attrs:{user:t.user,classList:["dashboard-header"]}}),a("div",{staticClass:"dashboard__container"},[t.isShowStory?a("Story",{attrs:{storyId:t.showStoryId,editVersion:t.showStoryEditVersion},on:{close:t.closeModal,approve:t.approveStory}}):t._e(),a("div",{staticClass:"dashboard__content"},[a("div",{staticClass:"dashboard__user"},[a("div",{staticClass:"dashboard__avatar"},[null!==t.user&&null!==t.user.profilePhoto&&"undefined"!==typeof t.user.profilePhoto.url?a("img",{attrs:{src:t.user.profilePhoto.url,alt:"avatar"}}):a("img",{attrs:{src:s("47ed"),alt:"avatar"}})]),a("h1",{staticClass:"dashboard__user-name"},[t._v(t._s(t.$ml.with("name",null!==t.user?t.user.name:"").get("dashboard.user.welcome")))])]),a("div",{staticClass:"dashboard__sites"},[a("div",{staticClass:"dashboard__site"},[a("div",{staticClass:"site__content"},[a("div",{staticClass:"site__header"},[a("span",{staticClass:"site__label"},[t._v(t._s(t.$ml.get("dashboard.memorial.label")))])]),a("div",{staticClass:"site__memorial"},[a("div",{staticClass:"memorial__description"},[a("div",{staticClass:"memorial__date"},[a("span",{staticClass:"memorial__label"},[t._v(t._s(t.$ml.get("dashboard.memorial.createdAt")))]),a("span",{staticClass:"memorial__value"},[t._v(t._s(t.$dateUtils.formatDate(t.memorial.createdAt,"dd/MM/yyyy")))])]),a("div",{staticClass:"memorial__subsription"},[a("span",{staticClass:"memorial__label"},[t._v(t._s(t.$ml.get("dashboard.memorial.plan.label")))]),t.memorial.paid&&null!==t.memorial.paymentPlan&&"undefined"!==typeof t.memorial.paymentPlan&&"monthly"===t.memorial.paymentPlan.type?a("span",{staticClass:"memorial__value"},[t._v(t._s(t.$ml.with("amount",t.$ml.get("payments.monthly.price")).get("dashboard.memorial.plan.monthly")))]):t.memorial.paid&&null!==t.memorial.paymentPlan&&"undefined"!==typeof t.memorial.paymentPlan&&"once"===t.memorial.paymentPlan.type?a("span",{staticClass:"memorial__value"},[t._v(t._s(t.$ml.with("amount",t.$ml.get("payments.once.price")).get("dashboard.memorial.plan.once")))]):a("router-link",{staticClass:"memorial__value underline",attrs:{tag:"span",to:{name:"memorials.payment",params:{slug:t.memorial.id}}}},[t._v(t._s(t.$ml.get("dashboard.memorial.plan.choose")))])],1)]),a("div",{staticClass:"memorial__control"},[a("Button",{attrs:{classList:["btn","btn__second","btn-edit"],label:t.$ml.get("dashboard.memorial.control.edit")},on:{clicked:function(e){return t.goTo("memorials.edit",{id:t.memorial.id},"_blank")}}}),a("Button",{attrs:{classList:["btn","btn__second","btn-preview"],label:t.$ml.get("dashboard.memorial.control.preview")},on:{clicked:function(e){return t.goTo("memorials.show",{slug:t.memorial.id},"_blank")}}}),a("Button",{attrs:{classList:["btn","btn__create","btn-add"],label:t.$ml.get("dashboard.memorial.control.add")},on:{clicked:function(e){return t.goTo("memorials.story.auth",{slug:t.memorial.id},"_blank")}}},[a("span",{staticClass:"icon plus plus-blue",attrs:{slot:"icon-left"},slot:"icon-left"})])],1)]),a("div",{staticClass:"site__stories"},[a("div",{staticClass:"stories__info"},[a("div",{staticClass:"stories__control"}),a("div",{staticClass:"stories__label"},[a("div",{staticClass:"title"},[a("span",{staticClass:"text"},[t._v(t._s(t.$ml.get("dashboard.memorial.stories.label")))]),a("span",{staticClass:"icon icon__info ask-icon",on:{click:function(e){t.isTooltipShow=!t.isTooltipShow}}})]),a("div",{staticClass:"description"},[a("span",{staticClass:"text"},[t._v(t._s(t.$ml.get("dashboard.memorial.stories.description")))])])]),a("Button",{attrs:{classList:["btn","btn__second","btn-add"],label:t.$ml.get("dashboard.memorial.stories.btn.add")},on:{clicked:function(e){return t.goTo("memorials.story.share",{slug:t.memorial.id},"_blank")}}},[a("span",{staticClass:"icon icon__add-blue add-icon",attrs:{slot:"icon-left"},slot:"icon-left"})])],1),a("div",{class:["stories__items",{notfound:!t.isStoriesExist(t.memorial.id)}]},[t.isStoriesExist(t.memorial.id)?t.stories[t.memorial.id].length>0?a("div",{staticClass:"swiper-container swiper",attrs:{id:t.$stringUtils.toCamelCase("story-"+t.memorial.slug)}},[a("div",{staticClass:"swiper-wrapper"},t._l(t.stories[t.memorial.id],(function(e){return a("div",{key:e.id,staticClass:"stories__item swiper-slide"},[a("div",{staticClass:"stories__created"},[a("span",{staticClass:"label"},[t._v(t._s(t.$ml.get("dashboard.memorial.story.created")))]),a("span",{staticClass:"date"},[t._v(t._s(t.formatStoryDate(t.memorial.createdAt)))])]),a("div",{staticClass:"stories__content"},[a("div",{staticClass:"info"},[a("div",{staticClass:"story__person"},[null!==e.owner&&null!==e.owner.user.profilePhoto&&"undefined"!==typeof e.owner.user.profilePhoto.url?a("img",{staticClass:"person__photo",attrs:{src:e.owner.user.profilePhoto.url,alt:"photo"}}):a("img",{staticClass:"person__photo",attrs:{src:s("997e"),alt:"photo"}}),a("div",{staticClass:"person__info"},[a("span",{staticClass:"name"},[t._v(t._s(e.owner.user.name))]),a("span",{staticClass:"company"},[t._v(t._s(e.owner.relationToMemorialPerson))])])]),a("div",{staticClass:"approval"},[a("Button",{attrs:{classList:["btn","btn__primary","approval__btn"],label:t.$ml.get("dashboard.memorial.story.btn.approval")},on:{clicked:function(s){return t.showStory(e)}}}),a("div",{staticClass:"approval__need"})],1)]),a("div",{staticClass:"btn btn__label btn-relative"},[a("span",{staticClass:"icon icon__label-blue label-icon"}),a("span",{staticClass:"period-name"},[t._v(t._s(e.period.name))])])])])})),0),a("div",{class:"swiper-button-prev swiper-button btn-prev-"+t.memorial.slug,attrs:{slot:"button-prev"},slot:"button-prev"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18.787",height:"18.787",viewBox:"0 0 18.787 18.787"}},[a("path",{attrs:{id:"Path_1969","data-name":"Path 1969",d:"M22.787,12.219H8.5l6.564-6.564L13.393,4,4,13.393l9.393,9.393,1.656-1.656L8.5,14.568h14.29Z",transform:"translate(-4 -4)",fill:"currentColor"}})])]),a("div",{class:"swiper-button-next swiper-button btn-next-"+t.memorial.slug,attrs:{slot:"button-next"},slot:"button-next"},[a("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"18.787",height:"18.787",viewBox:"0 0 18.787 18.787"}},[a("path",{attrs:{id:"Path_1969","data-name":"Path 1969",d:"M18.787,8.219H4.5l6.564-6.564L9.393,0,0,9.393l9.393,9.393,1.656-1.656L4.5,10.568h14.29Z",fill:"currentColor"}})])])]):t._e():a("div",{staticClass:"stories__item stories__notfound"},[a("span",{staticClass:"text"},[t._v(t._s(t.$ml.get("dashboard.memorial.stories.notfound")))])])])])])])])])],1),a("HelpCenter"),t.isTooltipShow?a("Tooltip",{attrs:{label:t.$ml.get("dashboard.help.label"),withTalkLink:!1},on:{close:function(e){t.isTooltipShow=!1}}},[a("div",{staticClass:"tooltip__description",attrs:{slot:"content"},slot:"content"},[a("span",[t._v(" "+t._s(t.$ml.get("dashboard.help.text"))+" ")])])]):t._e(),a("Footer")],1)},i=[],o=(s("b64b"),s("96cf"),s("1da1")),r=s("5530"),n=s("c661"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-footer"},[a("div",{staticClass:"dashboard-footer__container"},[a("div",{staticClass:"dashboard-footer__title-wrapper"},[a("span",{staticClass:"dashboard-footer__logo"}),a("div",{staticClass:"dashboard-footer__text"},[t._v(" "+t._s(t.$ml.get("dashboard.footer.text"))+" ")])]),a("div",{staticClass:"dashboard-footer__bottom"},[a("div",{staticClass:"dashboard-footer__privacy"},[a("a",{attrs:{href:"./files/"+t.$ml.get("footer.link3File")}},[a("img",{attrs:{src:s("c721"),alt:""}}),t._v(t._s(t.$ml.get("dashboard.footer.privacy.links.abuse")))]),a("a",{attrs:{href:"./files/"+t.$ml.get("footer.link2File")}},[t._v(t._s(t.$ml.get("dashboard.footer.privacy.links.privacy")))]),a("a",{attrs:{href:"./files/"+t.$ml.get("footer.link1File")}},[t._v(t._s(t.$ml.get("dashboard.footer.privacy.links.terms")))])]),a("div",{staticClass:"dashboard-footer__control"},[a("Button",{attrs:{classList:["btn","btn__third","dashboard-footer__btn","history"],label:t.$ml.get("dashboard.footer.controls.history.label")},on:{clicked:function(e){t.openLink(t.$ml.get("dashboard.footer.controls.history.link"))}}}),a("Button",{attrs:{classList:["btn","btn__third","dashboard-footer__btn","you"],label:t.$ml.get("dashboard.footer.controls.you.label")},on:{clicked:t.openHelp}})],1),a("div",{staticClass:"dashboard-footer__rights"},[t._v(" "+t._s(t.$ml.with("year",(new Date).getFullYear()).get("dashboard.footer.privacy.label"))+" ")])])])])},c=[],d=s("2a7d"),m=s("4a9d"),u={name:"Footer",components:{Button:d["a"]},methods:{openLink:function(t){t&&window.open(t,"_blank")},openHelp:function(){m["a"].$emit("help-center-open")}}},p=u,h=(s("a79b"),s("2877")),_=Object(h["a"])(p,l,c,!1,null,"44a3e493",null),f=_.exports,b=s("e2cc3"),v=s("24c2"),g=s("6d3b"),y=s("8343"),w=(s("bbe3"),s("2f62")),C=s("1f24");g["a"].use([y["a"]]);var k={name:"Index",components:{Button:d["a"],Header:n["a"],Footer:f,HelpCenter:v["a"],Story:b["a"],Tooltip:C["a"]},data:function(){return{isTooltipShow:!1,swiperOptions:{slidesPerView:"auto",navigation:{nextEl:null,prevEl:null}},isShowStory:!1,showStoryId:null,showStoryEditVersion:null,showContextMenu:!1,slidersReady:[],slider:{}}},computed:Object(r["a"])({textDir:function(){return"he"===this.$ml.current},typeNext:function(){return"right"},typePrev:function(){return"left"}},Object(w["b"])({memorial:"dashboard/currentMemorial",stories:"dashboard/stories",user:"profile/getUser"})),watch:{"memorial.slug":function(t){this.sliderReInit()}},methods:{sliderReInit:function(){this.slider&&Object.keys(this.slider).length&&this.slider.destroy(!0,!0),this.initSlider()},initSlider:function(){var t=this,e=this;setTimeout((function(){document.querySelector("#".concat(e.$stringUtils.toCamelCase("story-".concat(e.memorial.slug))))&&(t.swiperOptions["navigation"]["nextEl"]=".swiper-button-next",t.swiperOptions["navigation"]["prevEl"]=".swiper-button-prev",t.slider=new g["a"]("#".concat(e.$stringUtils.toCamelCase("story-".concat(e.memorial.slug))),e.swiperOptions))}),1e3)},closeModal:function(){this.isShowStory=!1,this.showStoryId=null,this.showStoryEditVersion=null,this.$store.dispatch("story/saveStory",{})},approveStory:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.closeModal(),e.next=3,t.updateMemorial();case 3:t.sliderReInit();case 4:case"end":return e.stop()}}),e)})))()},hideContextMenu:function(){this.showContextMenu=!1},updateMemorial:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("dashboard/setCurrentMemorial",t.memorial.id);case 2:case"end":return e.stop()}}),e)})))()},isStoriesExist:function(t){return"undefined"!==typeof this.stories[t]&&this.stories[t].length>0},formatStoryDate:function(t){return"en"===this.$ml.current?this.$dateUtils.formatDate(t,"MMMM dd, yyyy"):this.$dateUtils.formatDate(t,"dd MMMM yyyy","-",this.$ml.current)},showStory:function(t){this.isShowStory=!0,this.showStoryId=t.id,this.showStoryEditVersion=t.editVersion},goTo:function(t,e,s){if("_blank"===s){var a=this.$router.resolve({name:t,params:e});window.open(a.href,"_blank")}else this.$router.push(t,e)}},mounted:function(){var t=this,e=this;setTimeout((function(){e.initSlider()}),2e3);var s=this.$ml.bus;s.$on("vueml-language-changed",(function(){"undefined"!==typeof e.slider&&e.sliderReInit()})),m["a"].$on("approve",(function(){t.approveStory()}))},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$store.getters["auth/isLoggedIn"](["customer"])){e.next=3;break}return e.next=3,t.$router.push({name:"home"});case 3:case"end":return e.stop()}}),e)})))()}},x=k,$=(s("05a2"),Object(h["a"])(x,a,i,!1,null,"68efa989",null));e["default"]=$.exports},cd70:function(t,e,s){"use strict";s("1251")},d0b5:function(t,e,s){t.exports=s.p+"img/form-paper.5cfa0206.svg"},e0f6:function(t,e,s){t.exports=s.p+"img/facebook.c7033d43.svg"},e2cc3:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"scroll-lock",rawName:"v-scroll-lock",value:t.isShow,expression:"isShow"}],staticClass:"dashboard-story"},[t.showPeriodModal?a("PeriodModal",{attrs:{memorialId:t.memorial.id,periods:t.periods,defaultPeriod:t.period},on:{close:t.closePeriodModal,selectPeriod:t.setPeriod}}):t._e(),t.isTooltipShow?a("Tooltip",{attrs:{label:t.$ml.get("dashboard.story."+t.type+".help.label"),withTalkLink:!1},on:{close:function(e){t.isTooltipShow=!1}}},[a("div",{staticClass:"tooltip__description",attrs:{slot:"content"},slot:"content"},[a("span",[t._v(" "+t._s(t.$ml.get("dashboard.story."+t.type+".help.text"))+" ")])])]):t._e(),a("div",{ref:"modal",staticClass:"dashboard-story__modal",attrs:{tabindex:"0"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.close(e)}}},[a("div",{staticClass:"dashboard-story__header"},[a("span",{staticClass:"icon icon__close dashboard-story__close",on:{click:function(e){return e.preventDefault(),t.close(e)}}}),a("div",{staticClass:"dashboard-story__avatar"},[t.isStoryFieldExist("owner")&&null!==t.story.owner.user.profilePhoto&&"undefined"!==typeof t.story.owner.user.profilePhoto&&"ready"===t.story.owner.user.profilePhoto.status&&t.story.owner.user.profilePhoto.url?a("img",{attrs:{src:t.story.owner.user.profilePhoto.url,alt:"avatar"}}):a("img",{staticClass:"placeholder-avatar",attrs:{src:s("47ed"),alt:"avatar"}})]),a("div",{staticClass:"dashboard-story__user"},[a("span",{staticClass:"name"},[t._v(t._s(t.isStoryFieldExist("owner")?t.story.owner.user.name:""))]),a("span",{staticClass:"relative"},[t._v(t._s(t.isStoryFieldExist("owner")?t.story.owner.relationToMemorialPerson:""))])])]),a("div",{ref:"modalContent",staticClass:"dashboard-story__content"},[a("div",{staticClass:"dashboard-story__associating"},[a("div",{staticClass:"associating__content"},[a("div",{staticClass:"periods"},[a("div",{staticClass:"label"},[a("span",{staticClass:"text"},[t._v(t._s(t.$ml.get("story.common.form.labels.associating")))]),a("span",{staticClass:"icon icon__info ask-icon",on:{click:function(e){return t.showTooltip("period")}}})]),a("div",{staticClass:"dropdown-wrapper",on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openPeriodModal()}}},[a("div",{class:["associating","memorial"]},[a("span",{staticClass:"icon icon__label-blue"}),a("span",{staticClass:"text",domProps:{innerHTML:t._s(t.period.name)}}),a("span",{staticClass:"icon caret"})])])]),a("div",{staticClass:"visible"},["memorial"===this.$route.meta.type?a("div",{staticClass:"label"},[a("span",{staticClass:"text"},[t._v(t._s(t.$ml.get("story.common.form.labels.visible")))]),a("span",{staticClass:"icon icon__info ask-icon",on:{click:function(e){return t.showTooltip("visible")}}})]):t._e(),"memorial"===this.$route.meta.type?a("div",{staticClass:"dropdown-wrapper"},[a("div",{staticClass:"memorial-sidebar__switcher-wrapper memorial-sidebar__switcher-wrapper--indent",on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.isStoryVisible=!t.isStoryVisible}}},[t.isStoryVisible?a("span",[t._v(t._s(t.$ml.get("editMemorial.sidebar.relatives.editBlock.story.show")))]):a("span",[t._v(t._s(t.$ml.get("editMemorial.sidebar.relatives.editBlock.story.hide")))]),a("div",{class:["memorial-sidebar__switcher-box",{switch:!t.isStoryVisible}]},[a("div",{staticClass:"memorial-sidebar__switcher-point"})])])]):t._e()])]),a("span",{staticClass:"dashboard-story__label"},[t._v(t._s(t.$ml.get("story.common.form.labels.content")))])]),a("div",{staticClass:"dashboard-story__text"},[a("div",{staticClass:"story-form__description dashboard",attrs:{contentEditable:"true",value:t.description},domProps:{innerHTML:t._s(t.story.description)},on:{input:t.setDescription}}),a("div",{staticClass:"story-form__media dashboard"},t._l(t.contents,(function(e){return a("div",{key:e.id,staticClass:"upload__item"},[a("span",{staticClass:"icon icon__close remove",on:{click:function(s){return s.preventDefault(),t.removeMedia(e.type,e.id)}}}),"link"!==e.type||t.checkIsYouTubeLink(e.link)?"link"===e.type&&t.checkIsYouTubeLink(e.link)?a("div",{staticClass:"link__card"},[a("div",{staticClass:"upload__item"},[a("iframe",{attrs:{width:"100%",height:"300px",src:"https://www.youtube.com/embed/"+t.getVideoId(e.link),frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})])]):null!==e.file&&"file"===e.type&&"image"===e.contentType?a("img",{attrs:{src:e.file.url}}):null!==e.file&&"file"===e.type&&"video"===e.contentType&&"ready"===e.file.status?a("VideoPlayer",{attrs:{options:{autoplay:!1,controls:!0,sources:[{src:e.file.url}]}}}):null!==e.file&&"file"===e.type&&"audio"===e.contentType&&"ready"===e.file.status?a("AudioPlayer",{attrs:{sources:[{file:e.file.url,type:""}],classList:["create-story__audio"]}}):t._e():a("div",{staticClass:"link__card"},[a("img",{attrs:{src:e.previewImgLink,alt:""}}),a("div",{staticClass:"link__input"},[a("span",{staticClass:"icon icon__link link-icon"}),a("input",{attrs:{readonly:"",type:"text"},domProps:{value:e.link}})])])],1)})),0)])]),a("div",{staticClass:"dashboard-story__footer"},[a("Button",{attrs:{classList:["btn","btn__second","btn-draft"],label:"memorial"===this.$route.meta.type?t.$ml.get("dashboard.story.controls.cancel"):t.$ml.get("dashboard.story.controls.draft")},on:{clicked:t.saveAsDraft}}),"memorial"===this.$route.meta.type?a("Button",{attrs:{classList:["btn","btn__primary","btn-publish"],label:t.$ml.get("dashboard.story.controls.save")},on:{clicked:t.save}}):a("Button",{attrs:{classList:["btn","btn__primary","btn-publish"],label:t.$ml.get("dashboard.story.controls.publish")},on:{clicked:t.approve}})],1)])],1)},i=[],o=(s("a4d3"),s("e01a"),s("4de4"),s("c740"),s("d81d"),s("a434"),s("a9e3"),s("b64b"),s("ac1f"),s("5319"),s("498a"),s("9911"),s("96cf"),s("1da1")),r=s("5530"),n=s("2f62"),l=s("2a7d"),c=s("7901"),d=s("5912"),m=s("84c6"),u=s("c1bd"),p=s("1f24"),h=s("4a9d"),_={name:"Story",components:{Button:l["a"],AudioPlayer:c["a"],VideoPlayer:d["a"],PeriodModal:m["a"],Tooltip:p["a"]},props:{storyId:{type:[String,Number],default:null},editVersion:{type:[String,Number],default:null},isVisible:{type:Boolean,default:!1}},data:function(){return{isTooltipShow:!1,isShow:!0,showPeriodModal:!1,period:{},isStoryVisible:!1,isOldStoryVisible:!1,oldPeriodId:null,type:"period",description:"",contents:[]}},computed:Object(r["a"])({},Object(n["b"])({story:"story/story",memorial:"dashboard/currentMemorial",periods:"period/getPeriods"})),methods:{setDescription:function(t){this.description=t.target.innerHTML.replace(/(<([^>]+)>)/gi," "),"<br>"===t.target.innerHTML.trim()&&(t.target.innerHTML="",this.description="")},removeMedia:function(t,e){var s=this.contents.findIndex((function(s){return t===s.type||s.id===e}));this.contents.splice(s,1)},showTooltip:function(t){"dashboard"===this.$route.meta.type&&"period"===t?this.type="period1":this.type=t,this.isTooltipShow=!0},close:function(){this.isShow=!1,this.$emit("close")},save:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s,a,i,o,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.contents.filter((function(t){if("file"===t.type&&null!==t.file)return t})),a=t.contents.filter((function(t){if("link"===t.type)return t})),i={id:t.story.id,data:{editVersion:t.editVersion,memorialPeriodId:t.period.id,visible:t.isStoryVisible,description:t.description,files:s.map((function(t){return{id:t.file.id,contentType:t.contentType,description:t.description}})),links:a.map((function(t){return{link:t.link,description:t.description}}))}},"dashboard"===t.$route.meta.type&&(i.data["approvalRequested"]=!0),e.next=6,t.$store.dispatch("story/update",i);case 6:if(o=e.sent,!o.status){e.next=20;break}if("memorial"!==t.$route.meta.type){e.next=13;break}return e.next=11,t.$store.dispatch("story/updateEditStories",o.data);case 11:e.next=16;break;case 13:return r={memorialId:t.memorial.id,data:o.data},e.next=16,t.$store.dispatch("dashboard/updateStories",r);case 16:return t.close(),e.abrupt("return",{status:!0,data:o.data});case 20:return alert(o.data.response.data.errorDescription),e.abrupt("return",{status:!1,data:o.data.response.data.errorDescription});case 22:case"end":return e.stop()}}),e)})))()},saveAsDraft:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.save();case 2:s=e.sent,s&&t.close();case 4:case"end":return e.stop()}}),e)})))()},approve:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.save();case 2:if(s=e.sent,!s.status){e.next=15;break}return e.next=6,t.$store.dispatch("story/approve",{id:s.data.id,editVersion:s.data.editVersion});case 6:if(a=e.sent,!a.status){e.next=13;break}return t.isShow=!1,h["a"].$emit("approve"),e.abrupt("return",!0);case 13:return alert(s.data.errorDescription),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})))()},isStoryFieldExist:function(t){return null!==this.story[t]&&"undefined"!==typeof this.story[t]},openPeriodModal:function(){this.showPeriodModal=!0},closePeriodModal:function(){this.showPeriodModal=!1},setPeriod:function(t){this.period=t},checkIsYouTubeLink:function(t){return Object(u["a"])(t)},getVideoId:function(t){return Object(u["b"])(t)}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("story/getStory",t.storyId);case 2:return"undefined"!==typeof t.story&&0!==Object.keys(t.story).length||t.close(),t.period=t.story.period,t.isStoryVisible=t.isVisible,e.next=7,t.$store.dispatch("period/getPeriods",{id:t.memorial.id,withGeneral:!0});case 7:t.$refs["modal"]&&t.$refs["modal"].focus(),t.description=t.story.description,t.contents=Object.assign([],t.story.content);case 10:case"end":return e.stop()}}),e)})))()}},f=_,b=(s("f8a1"),s("2877")),v=Object(b["a"])(f,a,i,!1,null,"32ec1c07",null);e["a"]=v.exports},e4f4:function(t,e,s){t.exports=s.p+"img/whatsapp.5dd9d599.svg"},f8a1:function(t,e,s){"use strict";s("1b72")},f95a:function(t,e,s){}}]);
//# sourceMappingURL=chunk-301fe5e6.40eab620.js.map