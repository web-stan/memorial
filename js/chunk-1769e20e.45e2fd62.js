(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1769e20e"],{"029f":function(e,t,a){"use strict";a("b7ae")},"0d58":function(e,t,a){},1270:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["custom-input",{invalid:e.invalid}].concat(e.classList)},[e.label?a("span",{staticClass:"label"},[e._v(e._s(e.label))]):e._e(),a("input",{ref:"input",attrs:{readonly:e.readOnly},domProps:{value:e.inputVal},on:{input:function(t){return e.$emit("update:inputVal",t.target.value)},blur:e.emitBlur,focus:function(t){e.isFocus=!0}}}),e.invalid?a("div",{staticClass:"custom-input__error"},[e.isFocus?e._e():a("span",{staticClass:"icon icon__error error-icon"}),a("span",[e._v(e._s(e.errorLabel))])]):e._e(),e.inputVal.length>0?a("span",{staticClass:"icon icon__clear clear",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.clearInput(t)}}}):e._e(),e.invalid&&0===e.inputVal.length&&e.isFocus?a("span",{staticClass:"icon icon__error error"}):e._e()])},s=[],r={name:"Input",props:{classList:{type:Array,default:function(){return[]}},inputVal:{type:String,default:""},label:{type:String,default:""},invalid:{type:Boolean,default:!1},errorLabel:{type:String,default:""},readOnly:{type:Boolean,default:!1}},data:function(){return{showClear:!1,isFocus:!1}},methods:{clearInput:function(){this.$emit("update:inputVal",""),this.$refs["input"].focus()},emitBlur:function(){this.isFocus=!1,this.$emit("blur")}}},o=r,n=(a("029f"),a("2877")),l=Object(n["a"])(o,i,s,!1,null,"58b0170b",null);t["a"]=l.exports},"25f9":function(e,t,a){"use strict";a("6c4b")},3137:function(e,t,a){"use strict";a("d777")},"42de":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onClickOutside,expression:"onClickOutside"}],class:["select"].concat(e.customClasses,[{open:e.isActive}],[{invalid:e.isInvalid}])},[a("div",{staticClass:"select__backdrop",on:{click:function(t){e.isActive=!1}}}),a("div",{class:["select__input"]},[e._t("icon"),a("span",{class:["select__label",{open:e.isActive||null!==e.selectedItem.label&&e.selectedItem.label.length>0}]},[e._v(e._s(e.label))]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedItem.label,expression:"selectedItem.label"}],class:["select","select__value",{filled:null!==e.selectedItem.label&&e.selectedItem.label.length>0}],attrs:{placeholder:e.placeholder,readonly:e.isReadOnly},domProps:{value:e.selectedItem.label},on:{focus:function(t){e.isActive=!0},input:[function(t){t.target.composing||e.$set(e.selectedItem,"label",t.target.value)},e.setText],blur:function(t){return e.$emit("blur")}}}),a("div",{staticClass:"select__arrow",on:{click:function(t){t.preventDefault(),e.isActive=!e.isActive}}},[e._t("arrow",[a("span",{class:["icon",{"icon-up":e.isActive,"icon-down":!e.isActive}]})])],2)],2),e.items.length>0?a("div",{staticClass:"select__dropdown"},[a("ul",{staticClass:"select__list"},e._l(e.items,(function(t,i){return a("li",{key:t.value,class:["select__item",{selected:t.value===e.selectedItem.value}],attrs:{"data-value":t.value},on:{click:function(a){return a.preventDefault(),e.selectItem(t)}}},[e._v(e._s(t.label))])})),0)]):e._e()])},s=[],r=(a("7db0"),a("a9e3"),a("53ca")),o={name:"Select",props:{defaultItem:[Object,String,Number],items:{type:[Array,Object],default:function(){return[]}},placeholder:{type:String,default:""},label:{type:String,default:""},isInvalid:{type:Boolean,default:!1},isReadOnly:{type:Boolean,default:!0},customClasses:{type:[Array,String],default:""}},data:function(){return{selectedItem:{value:null,label:null},isActive:!1}},methods:{setText:function(e){this.isReadOnly||this.$emit("inputText",e.target.value)},selectItem:function(e){this.isActive=!1,this.selectedItem=Object.assign({},e),this.$emit("selected",this.selectedItem)},onClickOutside:function(){this.isActive=!1},formatItems:function(){for(var e=0;e<this.items.length;e++)this.items[e].labelCode&&(this.items[e].label=this.$ml.get(this.items[e].labelCode))}},mounted:function(){var e=this;this.formatItems();var t=this.$ml.bus,a=this;if(t.$on("vueml-language-changed",(function(e){a.formatItems()})),this.defaultItem)if("object"===Object(r["a"])(this.defaultItem)){var i=this.items.find((function(t){return t.value===e.defaultItem}));i&&(this.selectedItem=i)}else"string"===typeof this.defaultItem&&(this.selectedItem.label=this.defaultItem,this.selectedItem.value=this.defaultItem)}},n=o,l=(a("ef90"),a("2877")),c=Object(l["a"])(n,i,s,!1,null,"1a3a35ae",null);t["a"]=c.exports},"466d":function(e,t,a){"use strict";var i=a("d784"),s=a("825a"),r=a("50c4"),o=a("1d80"),n=a("8aa5"),l=a("14c3");i("match",1,(function(e,t,a){return[function(t){var a=o(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,a):new RegExp(t)[e](String(a))},function(e){var i=a(t,e,this);if(i.done)return i.value;var o=s(e),c=String(this);if(!o.global)return l(o,c);var u=o.unicode;o.lastIndex=0;var d,m=[],p=0;while(null!==(d=l(o,c))){var h=String(d[0]);m[p]=h,""===h&&(o.lastIndex=n(c,r(o.lastIndex),u)),p++}return 0===p?null:m}]}))},"469b":function(e,t,a){},"6c4b":function(e,t,a){},"816e":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"story"},[a(e.step,{tag:"component",on:{changeStep:e.changeStep}}),a("Sidebar",{attrs:{relativeUsers:e.relativeUsers,step:e.step}}),a("HelpCenter")],1)},s=[],r=(a("a434"),a("b0c0"),a("96cf"),a("1da1")),o=a("5530"),n=a("2f62"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"story__content"},[i("header",{staticClass:"auth"},[i("Button",{attrs:{classList:["btn","btn__primary-2","story__back-memorial"],label:e.$ml.get("story.header.toMemorialBtn")},on:{clicked:e.goToMemorial}}),i("router-link",{attrs:{to:{name:"home"}}},[i("img",{staticClass:"story__logo",attrs:{src:a("dd60"),alt:"Logo"}})])],1),i("div",{staticClass:"story__label"},[e._v(" "+e._s(e.$ml.with("name",e.memorial.name).get("story.auth.label"))+" ")]),i("div",{staticClass:"story__form"},[i("form",{staticClass:"form"},[i("h5",{staticClass:"form__label"},[e._v(e._s(e.$ml.get("story.auth.form.label")))]),i("div",{staticClass:"form__group user"},[i("Select",{key:e.isUpdateName,attrs:{placeholder:e.$ml.get("story.auth.form.users.placeholder"),label:e.$ml.get("story.auth.form.users.label"),items:e.users,defaultItem:e.user,isReadOnly:!1,isInvalid:!e.isNameValid},on:{selected:e.setName,inputText:e.setNameFromText}})],1),i("div",{staticClass:"form__group"},[i("Select",{attrs:{placeholder:e.$ml.get("story.auth.form.relations.placeholder"),label:e.$ml.get("story.auth.form.relations.label"),items:e.relations,defaultItem:e.user.relation},on:{selected:e.setRelation}}),e.showRelationInput?i("Input",{class:["form__relation"],attrs:{label:e.$ml.get("story.auth.form.relations.label"),inputVal:e.relation,invalid:!e.isRelationValid,errorLabel:e.$ml.get("story.auth.validation.relation")},on:{"update:inputVal":function(t){e.relation=t},"update:input-val":function(t){e.relation=t},blur:e.setRelationFromText}}):e._e()],1),i("div",{staticClass:"form__group"},[i("div",{staticClass:"form__photo",on:{click:e.showUploadModal}},[e.isShowUploadModal?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.hideUploadModal,expression:"hideUploadModal"}],staticClass:"context-menu form__photo-upload-modal"},[i("div",{staticClass:"context-menu__items"},[i("div",{staticClass:"context-menu__item",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.logInWithFacebook(t)}}},[e._v("Get Facebook photo")]),i("label",{staticClass:"context-menu__item",attrs:{for:"uploadPhoto"}},[e._v(" Upload "),i("input",{staticClass:"input-hide",attrs:{type:"file",id:"uploadPhoto"},on:{change:e.uploadPhoto}})])])]):e._e(),i("div",{staticClass:"description"},[i("span",{staticClass:"label"},[e._v(e._s(e.$ml.get("story.auth.form.photo.label")))]),i("span",{staticClass:"text"},[e._v(e._s(e.$ml.get("story.auth.form.photo.text")))])]),null!==e.user.photo&&null!==e.user.photo.status&&null!==e.user.photo.url&&["facebook","ready"].includes(e.user.photo.status)?i("div",{staticClass:"loaded-photo",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.removePhoto(t)}}},[i("span",{staticClass:"icon icon__close remove-photo",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.removePhoto(t)}}}),i("img",{attrs:{src:e.user.photo.url,alt:"photo"}})]):i("img",{attrs:{src:a("c8e2"),alt:"photo"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.showUploadModal(t)}}})])]),i("Button",{attrs:{classList:["form__submit","btn","btn__primary",{disabled:e.formDisabled}],label:e.$ml.get("story.auth.form.submit")},on:{clicked:e.login}},[i("span",{staticClass:"icon icon__arrow-2 disabled btn-arrow",attrs:{slot:"icon-right"},slot:"icon-right"})])],1)])])},c=[];a("d81d"),a("fb6a"),a("b64b"),a("d3b7"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0"),a("2b3d"),a("99af");function u(e){return d.apply(this,arguments)}function d(){return d=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.getElementById("fb-root")||(a=t.createElement("div"),a.id="fb-root",t.body.appendChild(a),function(e,t){t=e.createElement("script"),t.type="text/javascript",t.async=!0,t.src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v".concat(Object({NODE_ENV:"production",BASE_URL:"/memorial/"}).VUE_APP_FB_VERSION,"&appId=").concat(Object({NODE_ENV:"production",BASE_URL:"/memorial/"}).VUE_APP_FB_APP_ID,"&redirect_uri=").concat(Object({NODE_ENV:"production",BASE_URL:"/memorial/"}).VUE_APP_FB_REDIRECT_URL),e.getElementsByTagName("head")[0].appendChild(t)}(t));case 1:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}var m=a("42de"),p=a("2a7d"),h=a("1270"),f={name:"StoryAuthStep",components:{Select:m["a"],Button:p["a"],Input:h["a"]},data:function(){return{step:"auth",isUpdateName:!1,showRelationInput:!1,relations:[],relation:"",name:"",isRelationValid:!0,isNameValid:!0,isShowUploadModal:!1,validationRules:{name:{min:1,max:244},relation:{min:1,max:244}},file:null}},methods:{validate:function(e){var t=this[e].replace(/ /g,""),a=t.length;this["is".concat(e[0].toUpperCase()+e.slice(1),"Valid")]=a>=this.validationRules[e].min&&a<=this.validationRules[e].max},setName:function(e){this.name=e.label,this.validate("name"),this.$store.dispatch("story/saveField",{field:"name",data:e.label}),"undefined"!==typeof e.photo&&this.$store.dispatch("story/saveField",{field:"photo",data:e.photo})},setNameFromText:function(e){this.name=e,this.validate("name"),this.$store.dispatch("story/saveField",{field:"name",data:e})},setRelation:function(e){17===parseInt(e.value)?(this.showRelationInput=!0,this.$store.dispatch("story/saveField",{field:"relation",data:""})):(this.showRelationInput=!1,this.relation="",this.$store.dispatch("story/saveField",{field:"relation",data:e.label}))},setRelationFromText:function(){this.validate("relation"),this.$store.dispatch("story/saveField",{field:"relation",data:this.relation})},removePhoto:function(){this.file=null,this.$store.dispatch("story/saveField",{field:"photo",data:{id:null,url:null,status:null}})},formatRelations:function(){var e=this;this.relations=Object.keys(this.relations).map((function(t){return{value:t,label:e.relations[t]}}))},saveFacebookData:function(e){this.$store.dispatch("auth/facebook",e),this.$store.dispatch("story/getFacebookData")},logInWithFacebook:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,"undefined"!==typeof window.FB){t.next=4;break}return t.next=4,u(document);case 4:window.FB.getLoginStatus((function(e){"connected"===e.status?a.saveFacebookData(e.authResponse):window.FB.login((function(e){e.authResponse&&a.saveFacebookData(e.authResponse)}))})),e.hideUploadModal();case 6:case"end":return t.stop()}}),t)})))()},login:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i,s,o,n,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.formDisabled){t.next=22;break}if(null===e.file){t.next=15;break}return a={file:e.file,type:"image"},t.next=5,e.$store.dispatch("memorial/upload",a);case 5:if(i=t.sent,!i.status){t.next=11;break}return t.next=9,e.$store.dispatch("story/saveField",{field:"photo",data:i.data});case 9:t.next=15;break;case 11:return alert(i.data),t.next=14,e.$store.dispatch("story/saveField",{field:"photo",data:null});case 14:return t.abrupt("return");case 15:s=null,o=null,null!==e.user&&null!==e.user.photo&&(e.user.photo.id?(o=null,s=e.user.photo.id):(s=null,o=e.user.photo.url)),n={memorialId:e.memorial.id,data:{relativeName:e.user.name,externalPhotoLink:o,profilePhotoId:s,relationToMemorialPerson:e.user.relation}},l=e.$store.dispatch("auth/relativeLogin",n),c=null,l.then((function(t){c=t.data.token,Object(r["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$store.dispatch("auth/setToken",{data:t.data,tokenType:"relative"});case 2:case"end":return a.stop()}}),a)})))(),c===e.$store.getters["auth/token"]&&(e.$emit("changeStep","create"),e.$router.push({name:"memorials.story.create"}))})).catch((function(e){}));case 22:case"end":return t.stop()}}),t)})))()},goToMemorial:function(){this.$router.push({name:"memorials.show",params:{slug:this.$route.params.slug}})},showUploadModal:function(){null!==this.user.photo&&"undefined"!==typeof this.users.photo&&null!==this.user.photo.url&&0!==this.user.photo.url.length||(this.isShowUploadModal=!0)},hideUploadModal:function(){this.isShowUploadModal=!1},uploadPhoto:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.target.files[0]){a.next=5;break}return t.file=e.target.files[0],i=URL.createObjectURL(e.target.files[0]),a.next=5,t.$store.dispatch("story/saveField",{field:"photo",data:{id:null,url:i,status:"ready"}});case 5:t.hideUploadModal();case 6:case"end":return a.stop()}}),a)})))()}},watch:{"$ml.current":{handler:function(e){this.relations=this.$ml.get("create.memorial.step1.form.relations"),this.formatRelations()},immediate:!0},user:{handler:function(e){this.isUpdateName=!this.isUpdateName},immediate:!0},relation:function(){this.setRelationFromText()}},computed:Object(o["a"])(Object(o["a"])({},Object(n["b"])({user:"story/user",users:"story/users",memorial:"story/memorial",relativeUsers:"story/relativeUsers",tokenType:"auth/tokenType"})),{},{formDisabled:function(){return null===this.user.name||null===this.user.relation||this.user.name.length<1||this.user.name.length>244||this.user.relation.length<1||this.user.relation.length>244}}),mounted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("customer"!==e.tokenType){t.next=5;break}return e.$emit("changeStep","create"),t.next=4,e.$router.push({name:"memorials.story.create"});case 4:return t.abrupt("return");case 5:return t.next=7,u(document);case 7:return t.next=9,e.$store.dispatch("auth/getToken");case 9:case"end":return t.stop()}}),t)})))()}},g=f,v=(a("25f9"),a("2877")),b=Object(v["a"])(g,l,c,!1,null,"2924b346",null),_=b.exports,y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"story__content"},[e.showPeriodModal?i("PeriodModal",{attrs:{memorialId:e.memorial.id,periods:e.periods,defaultPeriod:e.period},on:{close:e.closePeriodModal,selectPeriod:e.setPeriod}}):e._e(),i("header",{staticClass:"create"},[i("Button",{attrs:{classList:["btn","btn__primary-2","story__back"],label:e.$ml.get("create.memorial.common.buttons.back")},on:{clicked:e.back}},[i("span",{staticClass:"icon icon__arrow-3 btn-arrow",attrs:{slot:"icon-left"},slot:"icon-left"})]),i("router-link",{attrs:{to:{name:"home"}}},[i("img",{staticClass:"story__logo",attrs:{src:a("dd60"),alt:"Logo"}})])],1),i("div",{class:["story__label","create",{filled:e.isFilled}]},[e._v(" "+e._s(e.$ml.with("name",e.memorial.name).get("story.create.label"))+" ")]),i("div",{staticClass:"story-form create-story__form"},[this.isCreating?i("div",{staticClass:"disable-form"}):e._e(),i("div",{staticClass:"story-form__wrapper"},[i("div",{staticClass:"story-form__header"},[i("div",{staticClass:"story-form__avatar"},[null!==e.user.photo&&"undefined"!==typeof e.user.photo&&e.user.photo.url?i("img",{attrs:{src:e.user.photo.url,alt:"avatar"}}):i("img",{staticClass:"placeholder",attrs:{src:a("47ed"),alt:"avatar"}})]),i("div",{staticClass:"story-form__user"},[i("span",{staticClass:"name"},[e._v(e._s(e.user.name))]),i("span",{staticClass:"relative"},[e._v(e._s(e.user.relation))])])]),i("div",{staticClass:"story-form__content"},[i("div",{staticClass:"story-form__associating"},[i("div",{staticClass:"label"},[i("span",{staticClass:"text"},[e._v(e._s(e.$ml.get("story.common.form.labels.associating")))]),i("span",{staticClass:"icon icon__info ask-icon",on:{click:function(t){e.isTooltipShow=!e.isTooltipShow}}})]),i("div",{staticClass:"dropdown-wrapper",on:{click:function(t){e.showPeriodModal=!0}}},[i("div",{staticClass:"associating"},[i("span",{staticClass:"icon icon__label-blue"}),Object.keys(e.period).length&&!e.period.isGeneral?i("span",{staticClass:"text"},[e._v(e._s(e.period.name))]):i("span",{staticClass:"text"},[e._v(e._s(e.$ml.get("story.common.form.labels.general")))]),i("span",{staticClass:"icon caret"})])]),i("span",{staticClass:"story-form__label"},[e._v(e._s(e.$ml.get("story.create.form.label")))])]),i("div",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"story-form__text"},[i("span",{class:["record",{active:e.isRecorded}],on:{click:e.startRecordAudio}}),i("div",{staticClass:"story-form__description",attrs:{contentEditable:"true",inputmode:"text",placeholder:e.$ml.get("story.create.form.placeholder.description")},on:{input:e.setDescription},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),i("div",{ref:"media",staticClass:"story-form__media"}),i("div",{ref:"dropArea",class:["story-form__uploads",{drop__area:e.isDrop}],on:{dragenter:function(t){return t.preventDefault(),t.stopPropagation(),e.dropAreaHighlight(t)},dragover:function(t){return t.preventDefault(),t.stopPropagation(),e.dropAreaHighlight(t)},dragleave:function(t){return t.preventDefault(),t.stopPropagation(),e.dropAreaUnHighlight(t)},drop:function(t){return t.preventDefault(),t.stopPropagation(),e.handleDrop(t)}}},[e.isLink?i("div",{staticClass:"create-story__link-wrapper"},[i("span",{staticClass:"icon icon__close icon__close-blue close",on:{click:function(t){e.isLink=!1}}}),i("Input",{staticClass:"create-story__link",attrs:{label:"link",inputVal:e.link},on:{"update:inputVal":function(t){e.link=t},"update:input-val":function(t){e.link=t}}}),i("Button",{attrs:{classList:["btn","btn__primary-2","story__back-memorial"],label:"publish"},on:{clicked:e.addLink}})],1):e._e(),e.isDrop?i("div",{staticClass:"drop__label"},[i("span",{staticClass:"label"},[e._v(e._s(e.$ml.get("story.create.form.uploadFiles.dropArea.label")))]),i("span",{staticClass:"icon icon__plus plus-icon"})]):e.isLink||e.isDrop?e._e():i("span",{staticClass:"upload__label"},[e._v(" "+e._s(e.$ml.get("story.create.form.uploadFiles.label"))+" ")]),e.isLink||e.isDrop?e._e():i("div",{staticClass:"upload__options",attrs:{dir:"ltr"}},[i("div",{staticClass:"upload__option",on:{click:function(t){e.isLink=!0}}},[i("label",[i("span",{staticClass:"icon icon__link"}),i("span",{staticClass:"description"},[e._v(" "+e._s(e.$ml.get("story.create.form.uploadFiles.link"))+" ")])])]),i("div",{staticClass:"upload__option"},[i("input",{staticClass:"input-hide",attrs:{type:"file",id:"cameraInput",accept:"image/*,video/*",capture:"user"},on:{change:e.loadMedia}}),i("label",{attrs:{for:"cameraInput"}},[i("span",{staticClass:"icon icon__camera"}),i("span",{staticClass:"description"},[e._v(" "+e._s(e.$ml.get("story.create.form.uploadFiles.camera"))+" ")])])]),i("div",{staticClass:"upload__option"},[i("input",{staticClass:"input-hide",attrs:{type:"file",id:"imageInput",accept:"image/*,video/*"},on:{change:e.loadMedia}}),i("label",{attrs:{for:"imageInput"}},[i("span",{staticClass:"icon icon__image"}),i("span",{staticClass:"description"},[e._v(" "+e._s(e.$ml.get("story.create.form.uploadFiles.image"))+" ")])])]),i("div",{staticClass:"upload__option"},[i("input",{staticClass:"input-hide",attrs:{type:"file",id:"audioInput",accept:"audio/*"},on:{change:e.loadMedia}}),i("label",{attrs:{for:"audioInput"}},[i("span",{staticClass:"icon icon__audio"}),i("span",{staticClass:"description"},[e._v(" "+e._s(e.$ml.get("story.create.form.uploadFiles.audio"))+" ")])])])])])])]),i("div",{staticClass:"story-form__footer create"},[i("Button",{attrs:{classList:["form__submit","create","btn","btn__primary",{disabled:e.isSubmitDisable}],label:e.$ml.get("story.create.form.submit")},on:{clicked:e.createStory}},[i("span",{staticClass:"icon icon__arrow-2 disabled btn-arrow",attrs:{slot:"icon-right"},slot:"icon-right"})])],1)])]),e.isTooltipShow?i("Tooltip",{attrs:{label:e.$ml.get("story.create.help.label"),withTalkLink:!1},on:{close:function(t){e.isTooltipShow=!1}}},[i("div",{staticClass:"tooltip__description",attrs:{slot:"content"},slot:"content"},[i("span",[e._v(" "+e._s(e.$ml.get("story.create.help.text"))+" ")])])]):e._e()],1)},k=[];a("a4d3"),a("e01a"),a("4de4"),a("7db0"),a("4160"),a("caad"),a("2532"),a("466d"),a("498a"),a("9911"),a("159b");function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}function x(e){if(Array.isArray(e))return w(e)}a("d28b"),a("a630");function C(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}a("25f0");function $(e,t){if(e){if("string"===typeof e)return w(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?w(e,t):void 0}}function I(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e){return x(e)||C(e)||$(e)||I()}var O=a("2b0e"),T=a("7901"),j=a("84c6"),L=a("1f24"),S=a("c1bd"),F={name:"StoryCreateStep",components:{Input:h["a"],Button:p["a"],AudioPlayer:T["a"],PeriodModal:j["a"],Tooltip:L["a"]},data:function(){return{isTooltipShow:!1,description:"",files:{},links:[],period:{},isLink:!1,isDrop:!1,event:null,link:"",showPeriodModal:!1,errorFilesIndex:[],isFilled:!1,isCreating:!1,isRecorded:!1,mediaRecorder:null,stream:null,storyType:"all"}},computed:Object(o["a"])(Object(o["a"])({},Object(n["b"])({memorial:"story/memorial",user:"story/user",periods:"period/getPeriods",tokenType:"auth/tokenType",customer:"profile/getUser"})),{},{isSubmitDisable:function(){return this.isCreating||0===this.description.length},isLoggedIn:function(){return this.$store.getters["auth/isLoggedIn"](["relative","customer"])},isMobile:function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}}),watch:{isLoggedIn:{handler:function(e){e||this.$router.push({name:"memorials.story.auth",params:{slug:this.memorial.slug}})},immediate:!0}},methods:{startRecordAudio:function(e){e.stopPropagation(),this.isRecorded?this.audioStop():this.audioStart()},audioStart:function(){this.recordAudio()},audioStop:function(){this.mediaRecorder.stop()},recordAudio:function(){var e=this,t=this;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(a){if(e.mediaRecorder=new MediaRecorder(a),a.getAudioTracks().length>0){e.mediaRecorder.start(),t.isRecorded=!0;var i=[];e.mediaRecorder.addEventListener("dataavailable",(function(e){i.push(e.data)})),e.mediaRecorder.addEventListener("stop",(function(){t.isRecorded=!1,a.getTracks().forEach((function(e){return e.stop()}));var e=new Blob(i,{type:"audio/wav"});t.loadFile(e,"audio")}))}}))},addLink:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i,s,r,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.link.length){t.next=2;break}return t.abrupt("return");case 2:if(a=e.link.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g),null!==a){t.next=6;break}return alert("Invalid Link"),t.abrupt("return");case 6:if(e.links.push(e.link),e.link="",i=Object.keys(e.links)[Object.keys(e.links).length-1],s=e.links[i],r=Object(S["a"])(s),!r){t.next=16;break}o=Object(S["b"])(s),e.$refs["media"].insertAdjacentHTML("beforeend",'\n            <div class="upload__item">\n              <span class="icon icon__close remove" data-type="link" data-index="'.concat(i,'"></span>\n              <iframe\n                width="100%" height="300px"\n                src="https://www.youtube.com/embed/').concat(o,'"\n                frameborder="0"\n                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"\n                allowfullscreen\n              ></iframe>\n            </div>\n        ')),t.next=20;break;case 16:return t.next=18,e.$store.dispatch("story/getPreviewLink",s);case 18:n=t.sent,e.$refs["media"].insertAdjacentHTML("beforeend",'\n            <div class="upload__item">\n                <div class="link__card">\n                <img src="'.concat(n,'" alt="">\n                    <span class="icon icon__close remove" data-type="link" data-index="').concat(i,'"></span>\n                    <div class="link__input">\n                        <span class="icon icon__link link-icon"></span>\n                        <input readonly type="text" value="').concat(s,'">\n                    </div>\n                </div>\n            </div>\n        '));case 20:e.isLink=!1;case 21:case"end":return t.stop()}}),t)})))()},setDescription:function(e){this.description=e.target.innerHTML.replace(/(<([^>]+)>)/gi," "),"<br>"===e.target.innerHTML.trim()&&(e.target.innerHTML="",this.description="")},getFileType:function(e){if("undefined"!==typeof e){if(e.type.includes("image"))return"image";if(e.type.includes("video"))return"video";if(e.type.includes("audio"))return"audio"}return null},saveFile:function(e,t){"undefined"===typeof this.files[t]&&(this.files[t]=[]),this.files[t].push(e)},getLastFileByType:function(e){var t=Object.keys(this.files[e])[Object.keys(this.files[e]).length-1],a=this.files[e][t];return{file:a,index:t}},loadFile:function(e,t){this.saveFile(e,t),this.displayMedia(t)},loadMedia:function(e){if(e.target.files.length){var t=this.getFileType(e.target.files[0]);null!==t&&this.loadFile(e.target.files[0],t),e.target.value=""}},displayMedia:function(e){var t=this.getLastFileByType(e),a=this,i=new FileReader;if(i.readAsDataURL(t.file),["image","video"].includes(e)){var s="";switch(e){case"image":s='<img src="{src}"/>';break;case"video":s='<video preload="metadata" muted controls src="{src}"></video>';break}i.onloadend=function(i){a.$refs["media"].insertAdjacentHTML("beforeend",'\n            <div class="upload__item">\n                <span class="icon icon__close remove" data-type="'.concat(e,'" data-index="').concat(t.index,'"></span>\n                ').concat(s.replace("{src}",i.target.result),"\n            </div>\n        "))}}"audio"===e&&(i.onloadend=function(i){var s=O["default"].extend(T["a"]),r=new s({propsData:{sources:[{file:i.target.result,type:t.file.type}],classList:["create-story__audio"]}});a.$refs["media"].insertAdjacentHTML("beforeend",'\n            <div class="upload__item" id="audio-'.concat(t.index,'">\n                <span class="icon icon__close remove" data-type="').concat(e,'" data-index="').concat(t.index,'"></span>\n\n            </div>\n        ')),r.$mount();var o=document.getElementById("audio-".concat(t.index));o.appendChild(r.$el)})},removeHandler:function(e){var t=e.target.dataset,a=t.type,i=t.index;["image","video","audio"].includes(a)&&(this.files[a].splice(i,1),e.target.parentElement.remove()),"link"===a&&(this.links.splice(i,1),e.target.parentElement.remove())},dropAreaHighlight:function(){this.$refs["dropArea"].classList.add("highlight"),this.isDrop=!0},dropAreaUnHighlight:function(){this.$refs["dropArea"].classList.remove("highlight"),this.isDrop=!1},handleDrop:function(e){var t=this;this.dropAreaUnHighlight();var a=this,i=e.dataTransfer,s=i.files;R(s).forEach((function(e){var i=a.getFileType(e);t.loadFile(e,i)}))},closePeriodModal:function(){this.showPeriodModal=!1},setPeriod:function(e){this.period=e},uploadsFiles:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i,s,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a={image:[],video:[],audio:[]},!(Object.keys(e.files).length>0)){t.next=17;break}i=0;case 3:if(!(i<Object.keys(e.files).length)){t.next=17;break}s=0;case 5:if(!(s<e.files[Object.keys(e.files)[i]].length)){t.next=14;break}return r={memorialId:e.memorial.id,file:e.files[Object.keys(e.files)[i]][s],type:Object.keys(e.files)[i]},t.next=9,e.$store.dispatch("memorial/upload",r);case 9:o=e.$store.getters["memorial/getFile"],null!==o&&a[r.type].push(e.$store.getters["memorial/getFile"]);case 11:s++,t.next=5;break;case 14:i++,t.next=3;break;case 17:return t.abrupt("return",a);case 18:case"end":return t.stop()}}),t)})))()},createStory:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,i,s,r,o,n,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isSubmitDisable){t.next=2;break}return t.abrupt("return");case 2:return e.isCreating=!0,a=[],t.next=6,e.uploadsFiles();case 6:if(i=t.sent,Object.keys(i).forEach((function(e){Object.keys(i[e]).forEach((function(t){a.push({id:i[e][t].id,contentType:e,description:""})}))})),s=[],e.links.forEach((function(e){s.push({link:e,description:""})})),0!==e.periods.length){t.next=13;break}return t.next=13,e.$store.dispatch("period/getPeriods",{id:e.memorial.id});case 13:return r=e.periods.filter((function(e){return!0===e.isGeneral})),o={periodId:Object.keys(e.period).length?e.period.id:r[0].id,data:{approvalRequested:!0,visible:e.isLoggedIn&&"customer"===e.tokenType,description:e.description,files:a,links:s}},t.next=17,e.$store.dispatch("story/create",o);case 17:if(n=t.sent,!n){t.next=32;break}if(l=0,l+=e.checkError("image",i),l+=e.checkError("video",i),l+=e.checkError("audio",i),l>0&&alert("Not all files have been uploaded"),"customer"!==e.tokenType){t.next=29;break}return t.next=27,e.$router.push({name:"memorials.edit",params:{id:e.memorial.id}});case 27:t.next=32;break;case 29:return e.$emit("changeStep","share"),t.next=32,e.$router.push({name:"memorials.story.share"});case 32:e.isCreating=!1;case 33:case"end":return t.stop()}}),t)})))()},back:function(){this.isLoggedIn&&"customer"===this.tokenType?this.$router.push({name:"memorials.edit",params:{id:this.memorial.id}}):(this.$emit("changeStep","auth"),this.$router.push({name:"memorials.story.auth",params:{slug:this.$route.params.slug}}))},onResize:function(e){e.width;var t=e.height;this.isFilled=t>330},checkError:function(e,t){var a=0;if("undefined"!==typeof this.files[e]){var i=this.files[e].length,s=t[e].length;i!==s&&a++}return a}},mounted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$el.addEventListener("click",e.removeHandler),!e.$store.getters["auth/isLoggedIn"](["customer"])||"customer"!==e.tokenType){t.next=8;break}return t.next=4,e.$store.dispatch("profile/me");case 4:return t.next=6,e.$store.dispatch("story/saveField",{field:"name",data:e.customer.name});case 6:return t.next=8,e.$store.dispatch("story/saveField",{field:"photo",data:e.customer.profilePhoto});case 8:if("undefined"!==typeof e.memorial&&null!==e.memorial){t.next=11;break}return t.next=11,e.$store.dispatch("story/getMemorial",e.$route.params.slug);case 11:return t.next=13,e.$store.dispatch("period/getPeriods",{id:e.memorial.id});case 13:e.$route.params.period&&(e.period=e.periods.find((function(t){return t.id==e.$route.params.period})));case 14:case"end":return t.stop()}}),t)})))()},beforeDestroy:function(){this.$el.removeEventListener("click",this.removeHandler)}},A=F,E=(a("3137"),Object(v["a"])(A,y,k,!1,null,null,null)),M=E.exports,P=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"story__content"},[i("header",{staticClass:"share"},[i("router-link",{attrs:{to:{name:"home"}}},[i("img",{staticClass:"story__logo",attrs:{src:a("dd60"),alt:"Logo"}})])],1),i("div",{staticClass:"story__label create"},[e._v(" "+e._s(e.$ml.with("name",e.memorial.name).get("story.share.label"))+" ")]),i("div",{staticClass:"create-memorial__form"},[i("div",{staticClass:"create-memorial__form__wrapper share"},[i("div",{staticClass:"create-memorial__form__wrapper__inputs share height"},[i("form",{staticClass:"form"},[i("h5",{staticClass:"form__title form__mb create-story__label"},[e._v(" "+e._s(e.$ml.get("create.memorial.step2.form.title"))+" ")]),i("div",{staticClass:"form__middle share-story__copy-btn"},[i("div",{staticClass:"form__middle-descr"},[e._v(e._s(e.$ml.get("create.memorial.step2.form.input.description"))+" ")]),i("div",{staticClass:"form__middle-text",attrs:{contenteditable:"true"},on:{input:e.saveText}},[e._v(" "+e._s(e.form.text)+" ")]),i("a",{ref:"link",staticClass:"form__middle-link",attrs:{href:e.form.link}},[e._v(e._s(e.form.link))]),i("Button",{attrs:{classList:["btn","btn__primary-2","create-story__copy-btn"],label:e.$ml.get("create.memorial.step2.form.buttons.copy")},on:{clicked:e.copyLink}},[i("img",{attrs:{slot:"icon-left",src:a("d0b5"),alt:""},slot:"icon-left"})])],1),i("div",{staticClass:"form__contact-icon"},[i("span",[e._v(e._s(e.$ml.get("create.memorial.step2.form.contacts.label")))]),i("a",{staticClass:"form__contact-item",attrs:{target:"_blank",href:e.fbShareUrl}},[i("img",{attrs:{src:a("e0f6"),alt:""}})]),i("a",{staticClass:"form__contact-item",attrs:{target:"_blank",href:"#"},on:{click:function(t){return t.preventDefault(),e.shareToMessenger()}}},[i("img",{attrs:{src:a("9b25"),alt:""}})]),i("a",{staticClass:"form__contact-item",attrs:{target:"_blank",href:"whatsapp://send?text="+encodeURIComponent(e.shareText+"\n"+e.form.link),"data-action":"share/whatsapp/share"}},[i("img",{attrs:{src:a("e4f4"),alt:""}})]),i("a",{staticClass:"form__contact-item",attrs:{target:"_blank",href:"mailto:?body="+encodeURIComponent(e.shareText+"\n"+e.form.link)}},[i("img",{attrs:{src:a("ab7f"),alt:""}})])])])]),i("div",{staticClass:"form__btn-wrapper share-story__btn-wrapper"},[i("Button",{attrs:{classList:["btn","btn__primary","story-add"],label:e.$ml.get("story.share.buttons.add")},on:{clicked:function(t){return e.goTo("memorials.story.auth",{slug:e.$route.params.slug},"auth")}}},[i("span",{staticClass:"icon icon__plus icon__plus-white icon-add",attrs:{slot:"icon-right"},slot:"icon-right"})]),i("Button",{attrs:{classList:["btn","btn__second","story-btn"],label:e.$ml.get("story.share.buttons.story")},on:{clicked:e.goToMemorial}})],1)])])])},U=[],D={name:"Share",components:{Button:p["a"]},data:function(){return{form:{text:"",link:""}}},computed:Object(o["a"])(Object(o["a"])({},Object(n["b"])("story",{isMemorialExist:"isMemorialExist",shareText:"shareText",memorial:"memorial"})),{},{fbShareUrl:function(){var e=this.$router.resolve({name:"memorials.story.share",params:{slug:this.memorial.slug}});return"https://www.facebook.com/dialog/share?app_id=".concat(Object({NODE_ENV:"production",BASE_URL:"/memorial/"}).VUE_APP_FB_APP_ID,"&display=popup&href=").concat(encodeURIComponent(this.form.link),"&quote=").concat(encodeURIComponent(this.shareText),"&redirect_uri=").concat(encodeURIComponent(window.location.origin+e.href))}}),methods:{shareToMessenger:function(){var e=this.$router.resolve({name:"memorials.story.share",params:{slug:this.memorial.slug}}),t=window.mobileCheck()?"fb-messenger://share?link=".concat(encodeURIComponent(this.form.link)):"https://www.facebook.com/dialog/send?app_id=".concat(Object({NODE_ENV:"production",BASE_URL:"/memorial/"}).VUE_APP_FB_APP_ID,"&display=popup&link=").concat(encodeURIComponent(this.form.link),"&msg=").concat(encodeURIComponent(this.shareText),"&redirect_uri=").concat(encodeURIComponent(window.location.origin+e.href));window.open(t,"_blank")},saveText:function(e){this.$store.dispatch("story/saveShareText",e.target.innerText)},copyLink:function(){var e=this.$refs["link"];if(null!==e&&"undefined"!==typeof e){var t=e.getAttribute("href");null!==t&&"undefined"!==typeof t&&navigator.clipboard.writeText(e.getAttribute("href"))}},goTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.$router.push({name:e,params:t}),null!==a&&this.$emit("changeStep",a)},goToMemorial:function(){this.$store.getters["auth/isLoggedIn"](["customer"])?this.$router.push({name:"memorials.edit",params:{id:this.memorial.id}}):this.$router.push({name:"memorials.show",params:{slug:this.memorial.slug}})}},mounted:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$store.getters["auth/isLoggedIn"](["customer"])){t.next=5;break}return t.next=3,e.$store.dispatch("story/getOwnerMemorial",e.$route.params.slug);case 3:t.next=9;break;case 5:return t.next=7,e.$store.dispatch("auth/getToken");case 7:return t.next=9,e.$store.dispatch("story/getMemorial",e.$route.params.slug);case 9:if(e.isMemorialExist){t.next=12;break}return t.next=12,e.$router.push({name:"home"});case 12:return t.next=14,e.$store.dispatch("story/getRandomStories",{id:e.memorial.id,count:3});case 14:if(e.form.link="".concat(window.location.origin,"/memorials/").concat(e.memorial.slug,"/share"),e.shareText){t.next=21;break}return e.form.text=e.$ml.with("name",e.memorial.name).get("create.memorial.step2.form.input.text"),t.next=19,e.$store.dispatch("story/saveShareText",e.form.text);case 19:t.next=22;break;case 21:e.form.text=e.shareText;case 22:case"end":return t.stop()}}),t)})))()}},B=D,N=(a("f399"),Object(v["a"])(B,P,U,!1,null,null,null)),V=N.exports,z=a("24c2"),H=a("ea2c"),q={name:"StoryCreate",components:{Auth:_,Create:M,Share:V,Sidebar:H["a"],HelpCenter:z["a"]},data:function(){return{step:"auth"}},methods:{changeStep:function(e){this.step=e}},computed:Object(o["a"])(Object(o["a"])({},Object(n["b"])({isMemorialExist:"story/isMemorialExist",memorial:"story/memorial",tokenType:"auth/tokenType"})),{},{relativeUsers:function(){var e=this.$store.getters["story/relativeUsers"];return{count:e.length,data:e.splice(0,4)}}}),created:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.t0=e.$route.name,t.next="memorials.story.create"===t.t0?3:"memorials.story.share"===t.t0?5:(t.t0,7);break;case 3:return e.step="create",t.abrupt("break",9);case 5:return e.step="share",t.abrupt("break",9);case 7:return e.step="auth",t.abrupt("break",9);case 9:if(!e.$store.getters["auth/isLoggedIn"](["customer"])){t.next=14;break}return t.next=12,e.$store.dispatch("story/getOwnerMemorial",e.$route.params.slug);case 12:t.next=16;break;case 14:return t.next=16,e.$store.dispatch("story/getMemorial",e.$route.params.slug);case 16:if(e.isMemorialExist){t.next=20;break}return alert("Memorial not visible"),t.next=20,e.$router.push({name:"home"});case 20:case"end":return t.stop()}}),t)})))()}},G=q,J=(a("d4d7"),Object(v["a"])(G,i,s,!1,null,"30cc4ed5",null));t["default"]=J.exports},"9b25":function(e,t,a){e.exports=a.p+"img/facebook-messenger-1.0f6f9acb.svg"},ab7f:function(e,t,a){e.exports=a.p+"img/envelope-blue.d76ae40e.svg"},b7ae:function(e,t,a){},be61:function(e,t,a){},c1bd:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));a("ac1f"),a("466d");var i=function(e){if(e){var t=/^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;return!!e.match(t)}return!1},s=function(e){var t=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,a=e.match(t);return a&&11===a[7].length?a[7]:null}},c8e2:function(e,t,a){e.exports=a.p+"img/form-photo.0b40d536.svg"},d0b5:function(e,t,a){e.exports=a.p+"img/form-paper.5cfa0206.svg"},d4d7:function(e,t,a){"use strict";a("be61")},d777:function(e,t,a){},e0f6:function(e,t,a){e.exports=a.p+"img/facebook.c7033d43.svg"},e4f4:function(e,t,a){e.exports=a.p+"img/whatsapp.5dd9d599.svg"},ef90:function(e,t,a){"use strict";a("0d58")},f399:function(e,t,a){"use strict";a("469b")}}]);
//# sourceMappingURL=chunk-1769e20e.45e2fd62.js.map